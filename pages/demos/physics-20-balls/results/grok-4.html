<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ball Simulation</title>
</head>
<body>
    <canvas id="canvas" width="800" height="600" style="border: 1px solid black;"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        const centerX = width / 2;
        const centerY = height / 2;
        const hexSize = 200; // Radius to vertex of hexagon
        const rotationSpeed = Math.PI / 2; // Radians per second (90 degrees per second)
        const gravity = 500; // Pixels per second squared
        const numBalls = 20;

        let balls = [];
        for (let i = 0; i < numBalls; i++) {
            balls.push({
                x: centerX + (Math.random() - 0.5) * 10, // Small random offset
                y: centerY + (Math.random() - 0.5) * 10,
                vx: (Math.random() - 0.5) * 50, // Small random initial velocity
                vy: (Math.random() - 0.5) * 50,
                radius: 5,
                color: `hsl(${Math.random() * 360}, 100%, 50%)` // Random color
            });
        }

        let initialTime;
        let lastTime;

        function animate(time) {
            if (initialTime === undefined) initialTime = time;
            const elapsed = time - initialTime;

            let dt = 0;
            if (lastTime !== undefined) {
                dt = (time - lastTime) / 1000;
            }
            lastTime = time;

            // Calculate gravity direction (flips every 5 seconds)
            const currentTimeSec = elapsed / 1000;
            const flipCount = Math.floor(currentTimeSec / 5);
            const gravityDir = (flipCount % 2 === 0) ? 1 : -1; // 1: down, -1: up

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Draw spinning hexagon
            const rotation = (elapsed / 1000) * rotationSpeed;
            let points = [];
            for (let i = 0; i < 6; i++) {
                const angle = rotation + i * (2 * Math.PI / 6);
                const px = centerX + hexSize * Math.cos(angle);
                const py = centerY + hexSize * Math.sin(angle);
                points.push({ x: px, y: py });
            }
            ctx.beginPath();
            ctx.moveTo(points[0].x, points[0].y);
            for (let i = 1; i < points.length; i++) {
                ctx.lineTo(points[i].x, points[i].y);
            }
            ctx.closePath();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Update balls physics
            for (let ball of balls) {
                ball.vy += gravity * gravityDir * dt;
                ball.x += ball.vx * dt;
                ball.y += ball.vy * dt;
            }

            // Draw balls
            for (let ball of balls) {
                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ball.radius, 0, 2 * Math.PI);
                ctx.fillStyle = ball.color;
                ctx.fill();
            }

            requestAnimationFrame(animate);
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>
